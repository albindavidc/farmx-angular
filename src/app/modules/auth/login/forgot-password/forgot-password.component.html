<ng-container *ngIf="showEmailForm$ | async">
  <div class="page-wrapper">
    <div class="auth-container">
      <div class="header">
        <h1>Forgot Password?</h1>
        <p>Enter your email address and we'll send you a verification code</p>
      </div>

      <form #emailForm="ngForm" (ngSubmit)="onSubmitGenerateOtp(emailForm)">
        <div class="form-group">
          <label for="email">Email Address</label>
          <div class="input-wrapper">
            <input
              type="email"
              id="email"
              ngModel
              required
              email
              name="email"
              #emailInput="ngModel"
            />
            <div
              class="error-message"
              *ngIf="emailInput.invalid && emailInput.touched"
            >
              Please enter a valid email address
            </div>
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="!emailForm.valid"
        >
          Send Verification Code
        </button>
      </form>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="showOtpForm$ | async">
  <div class="page-wrapper">
    <div class="auth-container">
      <div class="header">
        <h1>Enter Verification Code</h1>
        <p>We've sent a 6-digit code to your email</p>
      </div>

      <form #otpForm="ngForm" (ngSubmit)="onSubmitValidateOtp(otpForm)">
        <div class="form-group">
          <label for="otp">Verification Code</label>
          <div class="input-wrapper">
            <input
              type="number"
              id="otp"
              ngModel
              required
              name="otp"
              #otpInput="ngModel"
              maxlength="6"
            />
            <div
              class="error-message"
              *ngIf="otpInput.invalid && otpInput.touched"
            >
              Please enter a valid 6-digit code
            </div>
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="!otpForm.valid"
        >
          Verify Code
        </button>

        <button type="button" class="btn btn-secondary" (click)="resendOtp()">
          Resend Code
        </button>
      </form>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="showChangePasswordForm">
  <div class="page-wrapper">
    <div class="auth-container">
      <div class="header">
        <h1>Set New Password</h1>
        <p>Create a strong password for your account</p>
      </div>

      <form
        #changePasswordForm="ngForm"
        (ngSubmit)="onSubmitChangePassword(changePasswordForm)"
      >
        <div class="form-group">
          <label for="newPassword">New Password</label>
          <div class="input-wrapper">
            <input
              type="password"
              id="newPassword"
              ngModel
              required
              name="newPassword"
              #newPasswordInput="ngModel"
              minlength="8"
            />
            <div
              class="error-message"
              *ngIf="newPasswordInput.invalid && newPasswordInput.touched"
            >
              Password must be at least 8 characters
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <div class="input-wrapper">
            <input
              type="password"
              id="confirmPassword"
              ngModel
              required
              name="confirmPassword"
              #confirmPasswordInput="ngModel"
            />
            <div
              class="error-message"
              *ngIf="
                confirmPasswordInput.invalid && confirmPasswordInput.touched
              "
            >
              Please confirm your password
            </div>
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="!changePasswordForm.valid"
        >
          Update Password
        </button>
      </form>
    </div>
  </div>
</ng-container>
